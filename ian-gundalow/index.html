<!DOCTYPE html>
<html>
<head>
	<link href="css/style.css" rel="stylesheet">
	<title>Ian's Gundalow Payment Service</title>

</head>
<body>
<H1>Ian's Gundalow Payment Service</H1>
<h2>Initial cost for 2021 is $912</h2>
<table id="paymentTable">
	<thead>
		<td class='heading'><h2>Payment date</h2></td>
		<td class='heading'><h2>Amount</h2></td>
	</thead>
</table>
<h2>Amount left is <span id='amtLeft'></span></h2>
<script>
	let paymentTable = document.getElementById('paymentTable');
	let amtLeft = 912;
	const urlToFetch = "payments.json";
	let info = {};
	const getData = async (info) => {
		const response = await fetch(urlToFetch);
		try{
			if(response.ok){
				info = await response.json();
				info.forEach(element => {
					createRow(element, paymentTable);
					amtLeft -= element.amount;
					document.getElementById('amtLeft').innerHTML= Math.floor(amtLeft);
				});

			}
		} catch(error){
			console.log(error);
		}
		
	}
	const createRow = (element, table) =>{
		let newRow = document.createElement('tr');
		paymentTable.appendChild(newRow);
		let newCell = document.createElement('td');
		newCell.innerHTML = element.date;
		newRow.appendChild(newCell);
		newCell = document.createElement('td');
		newCell.innerHTML = element.amount;
		newRow.appendChild(newCell);
	}
	getData(info);
</script>
</body>
</html>